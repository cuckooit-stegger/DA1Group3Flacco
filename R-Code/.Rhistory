bfeats3.pca_cor.ela$scores[,2],
bfeats3.pca_cor.ela$scores[,3],
angle=20, main="Clustering using all features", xlab="1 PC",
ylab="2 PC", zlab="3 PC", color=colors[bfeats3.clust2$cluster], pch=19, cex.lab=1, type="p")
scatterplot3d(bfeats3.pca_cor.ela$scores[,1],
bfeats3.pca_cor.ela$scores[,2],
bfeats3.pca_cor.ela$scores[,3],
angle=20, main="Clustering using only CM-Features", xlab="1 PC",
ylab="2 PC", zlab="3 PC",color=colors[bfeats3.ela.clust2$cluster], cex.lab=1, type="p", pch=19)
layout(matrix(1:2, ncol=2))
scatterplot3d(bfeats3.pca_cor.ela$scores[,1],
bfeats3.pca_cor.ela$scores[,2],
bfeats3.pca_cor.ela$scores[,3],
angle=75, main="Clustering using all features", xlab="1 PC",
ylab="2 PC", zlab="3 PC", color=colors[bfeats3.clust2$cluster], pch=19, cex.lab=1, type="p")
scatterplot3d(bfeats3.pca_cor.ela$scores[,1],
bfeats3.pca_cor.ela$scores[,2],
bfeats3.pca_cor.ela$scores[,3],
angle=20, main="Clustering using only CM-Features", xlab="1 PC",
ylab="2 PC", zlab="3 PC",color=colors[bfeats3.ela.clust2$cluster], cex.lab=1, type="p", pch=19)
scatterplot3d(bfeats3.pca_cor.ela$scores[,1],
bfeats3.pca_cor.ela$scores[,2],
bfeats3.pca_cor.ela$scores[,3],
angle=75, main="Clustering using all features", xlab="1 PC",
ylab="2 PC", zlab="3 PC", color=colors[bfeats3.clust2$cluster], pch=19, cex.lab=1, type="p")
scatterplot3d(bfeats3.pca_cor.ela$scores[,1],
bfeats3.pca_cor.ela$scores[,2],
bfeats3.pca_cor.ela$scores[,3],
angle=75, main="Clustering using all features", xlab="1 PC",
ylab="2 PC", zlab="3 PC", color=colors[bfeats3.clust2$cluster], pch=19, cex.lab=1, type="p")
scatterplot3d(bfeats3.pca_cor.ela$scores[,1],
bfeats3.pca_cor.ela$scores[,2],
bfeats3.pca_cor.ela$scores[,3],
angle=115, main="Clustering using all features", xlab="1 PC",
ylab="2 PC", zlab="3 PC", color=colors[bfeats3.clust2$cluster], pch=19, cex.lab=1, type="p")
scatterplot3d(bfeats3.pca_cor.ela$scores[,1],
bfeats3.pca_cor.ela$scores[,2],
bfeats3.pca_cor.ela$scores[,3],
angle=115, main="Clustering using only CM-Features", xlab="1 PC",
ylab="2 PC", zlab="3 PC",color=colors[bfeats3.ela.clust2$cluster], cex.lab=1, type="p", pch=19)
layout(matrix(1:2, ncol=2))
scatterplot3d(bfeats3.pca_cor.ela$scores[,1],
bfeats3.pca_cor.ela$scores[,2],
bfeats3.pca_cor.ela$scores[,3],
angle=115, main="Clustering using all features", xlab="1 PC",
ylab="2 PC", zlab="3 PC", color=colors[bfeats3.clust2$cluster], pch=19, cex.lab=1, type="p")
scatterplot3d(bfeats3.pca_cor.ela$scores[,1],
bfeats3.pca_cor.ela$scores[,2],
bfeats3.pca_cor.ela$scores[,3],
angle=115, main="Clustering using only CM-Features", xlab="1 PC",
ylab="2 PC", zlab="3 PC",color=colors[bfeats3.ela.clust2$cluster], cex.lab=1, type="p", pch=19)
which(bfeats3.clust2$cluster ==1 & bfeats3[,1]==1)
length(which(bfeats3.clust2$cluster ==1 & bfeats3[,1]==1))
length(which(bfeats3.clust2$cluster ==2 & bfeats3[,1]==2))
length(which(bfeats3.ela.clust2$cluster ==2 & bfeats3[,1]==2)) # 1352
length(which(bfeats3.ela.clust2$cluster ==2 & bfeats3[,1]==2)) # 1352
length(which(bfeats3.ela.clust2$cluster ==1 & bfeats3[,1]==1)) # 1352
length(which(bfeats3.ela.clust2$cluster ==2 & bfeats3[,1]==1)) # 1352
length(which(bfeats3.ela.clust2$cluster ==1 & bfeats3[,1]==2)) # 1352
length(which(bfeats3.ela.clust2$cluster ==1 & bfeats3[,1]==2)) # 1410
length(which(bfeats3.ela.clust2$cluster ==2 & bfeats3[,1]==1)) # 971
(1410+1352)/2880
(1410+971)/2880
pairs_noreg.custom(bfeats3.pca_cor$scores[,1:6], m="Scatterplot on PCs (2 clusters)", col=colors[bfeats3.clust2$cluster],
legend.title="Cluster",
legend.text=c("1", "2"), legend.col=colors[1:2])
scatterplot3d.custom(bfeats3.pca_cor$scores[,1], bfeats3.pca_cor$scores[,2], bfeats3.pca_cor$scores[,3],
angle=75, main="3D Scatterplot on 1., 2., 3. PC (2 clusters)", xlab="1 PC",
ylab="2 PC", zlab="3 PC", col=colors[bfeats3.clust2$cluster], legend.title="Cluster",
legend.text=c("1", "2"), legend.col=colors[c(1,2)])
scatterplot3d.custom(bfeats3.pca_cor$scores[,1], bfeats3.pca_cor$scores[,2], bfeats3.pca_cor$scores[,3],
angle=75, main="3D Scatterplot on 1., 2., 3. PC (5 clusters)", xlab="1 PC",
ylab="2 PC", zlab="3 PC", col=colors[bfeats3.clust5$cluster], legend.title="Cluster",
legend.text=c("1", "2", "3", "4", "5"), legend.col=colors[1:5])
pairs_noreg.custom(bfeats3.pca_cor$scores[which(metadata3[,1]==3),1:6], m="Scatterplot on PCs (block==3, 2 clusters)",
col=colors[bfeats3.block3.clust2$cluster],
legend.title="Cluster",
legend.text=c("1", "2"), legend.col=colors[1:2])
scatterplot3d.custom(bfeats3.pca_cor$scores[which(metadata3[,1]==3),1], bfeats3.pca_cor$scores[which(metadata3[,1]==3),2],
bfeats3.pca_cor$scores[which(metadata3[,1]==3),3],
angle=75, main="3D Scatterplot on 1., 2., 3. PC (block==3, 2 clusters)", xlab="1 PC",
ylab="2 PC", zlab="3 PC", col=colors[bfeats3.block3.clust2$cluster], legend.title="Cluster",
legend.text=c("1", "2"), legend.col=colors[c(1,2)])
pairs_noreg.custom(bfeats3.pca_cor$scores[which(metadata3[,1]==3 & bfeats3[,1]==1),1:6],
m="Scatterplot on PCs (block=3, top=funnel, 2 clusters)",
col=colors[bfeats3.top_fun.clust2$cluster],
legend.title="Cluster",
legend.text=c("1", "2"), legend.col=colors[1:2])
scatterplot3d.custom(bfeats3.pca_cor$scores[which(metadata3[,1]==3& bfeats3[,1]==1),1],
bfeats3.pca_cor$scores[which(metadata3[,1]==3& bfeats3[,1]==1),2],
bfeats3.pca_cor$scores[which(metadata3[,1]==3& bfeats3[,1]==1),3],
angle=75, main="3D Scatterplot on 1., 2., 3. PC (block=3, top=funnel, 2 clusters)", xlab="1 PC",
ylab="2 PC", zlab="3 PC", col=colors[bfeats3.top_fun.clust2$cluster], legend.title="Cluster",
legend.text=c("1", "2"), legend.col=colors[c(1,2)])
pairs_noreg.custom(bfeats3.pca_cor$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),1:6],
m="Scatterplot on PCs (block=3, top=random, 2 clusters)",
col=colors[bfeats3.top_ran.clust2$cluster],
legend.title="Cluster",
legend.text=c("1", "2"), legend.col=colors[1:2])
scatterplot3d.custom(bfeats3.pca_cor$scores[which(metadata3[,1]==3& bfeats3[,1]==2),1],
bfeats3.pca_cor$scores[which(metadata3[,1]==3& bfeats3[,1]==2),2],
bfeats3.pca_cor$scores[which(metadata3[,1]==3& bfeats3[,1]==2),3],
angle=75, main="3D Scatterplot on 1., 2., 3. PC (block=3, top=random, 2 clusters)", xlab="1 PC",
ylab="2 PC", zlab="3 PC", col=colors[bfeats3.top_ran.clust2$cluster], legend.title="Cluster",
legend.text=c("1", "2"), legend.col=colors[c(1,2)])
layout(matrix(1:2, ncol=2))
scatterplot3d(bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==1),1],
bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==1),2],
bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==1),3],
angle=20, main="Clustering using all features", xlab="1 PC",
ylab="2 PC", zlab="3 PC", color=colors[bfeats3.top_fun.clust2$cluster], pch=19, cex.lab=1, type="p")
scatterplot3d(bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==1),1],
bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==1),2],
bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==1),3],
angle=20, main="Clustering using only CM-Features", xlab="1 PC",
ylab="2 PC", zlab="3 PC",color=colors[bfeats3.cm.clust2$cluster], cex.lab=1, type="p", pch=19)
layout(matrix(1:2, ncol=2))
#clusters 96% correct
scatterplot3d(bfeats3.pca_cor.ela$scores[,1],
bfeats3.pca_cor.ela$scores[,2],
bfeats3.pca_cor.ela$scores[,3],
angle=115, main="Clustering using all features", xlab="1 PC",
ylab="2 PC", zlab="3 PC", color=colors[bfeats3.clust2$cluster], pch=19, cex.lab=1, type="p")
#clusters already 83% correctly
scatterplot3d(bfeats3.pca_cor.ela$scores[,1],
bfeats3.pca_cor.ela$scores[,2],
bfeats3.pca_cor.ela$scores[,3],
angle=115, main="Clustering using only ELA-Features", xlab="1 PC",
ylab="2 PC", zlab="3 PC",color=colors[bfeats3.ela.clust2$cluster], cex.lab=1, type="p", pch=19)
bfeats3.cm.clust2 = kmeans(bfeats3.s[which(metadata3[,1]==3 & bfeats3[,1]==2),2:18], centers=2, nstart=25)
layout(matrix(1:2, ncol=2))
scatterplot3d(bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),1],
bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),2],
bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),3],
angle=20, main="Clustering using all features", xlab="1 PC",
ylab="2 PC", zlab="3 PC", color=colors[bfeats3.top_fun.clust2$cluster], pch=19, cex.lab=1, type="p")
scatterplot3d(bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),1],
bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),2],
bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),3],
angle=20, main="Clustering using only CM-Features", xlab="1 PC",
ylab="2 PC", zlab="3 PC",color=colors[bfeats3.cm.clust2$cluster], cex.lab=1, type="p", pch=19)
layout(matrix(1:2, ncol=2))
scatterplot3d(bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),1],
bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),2],
bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),3],
angle=20, main="Clustering using all features", xlab="1 PC",
ylab="2 PC", zlab="3 PC", color=colors[bfeats3.top_ran.clust2$cluster], pch=19, cex.lab=1, type="p")
scatterplot3d(bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),1],
bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),2],
bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),3],
angle=20, main="Clustering using only CM-Features", xlab="1 PC",
ylab="2 PC", zlab="3 PC",color=colors[bfeats3.cm.clust2$cluster], cex.lab=1, type="p", pch=19)
scatterplot3d(bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),1],
bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),2],
bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),3],
angle=80, main="Clustering using all features", xlab="1 PC",
ylab="2 PC", zlab="3 PC", color=colors[bfeats3.top_ran.clust2$cluster], pch=19, cex.lab=1, type="p")
scatterplot3d(bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),1],
bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),2],
bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),3],
angle=150, main="Clustering using all features", xlab="1 PC",
ylab="2 PC", zlab="3 PC", color=colors[bfeats3.top_ran.clust2$cluster], pch=19, cex.lab=1, type="p")
layout(matrix(1:2, ncol=2))
scatterplot3d(bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==1),1],
bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==1),2],
bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==1),3],
angle=20, main="Clustering using all features", xlab="1 PC",
ylab="2 PC", zlab="3 PC", color=colors[bfeats3.top_fun.clust2$cluster], pch=19, cex.lab=1, type="p")
scatterplot3d(bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==1),1],
bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==1),2],
bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==1),3],
angle=20, main="Clustering using only CM-Features", xlab="1 PC",
ylab="2 PC", zlab="3 PC",color=colors[bfeats3.cm.clust2$cluster], cex.lab=1, type="p", pch=19)
bfeats3.cm.clust2 = kmeans(bfeats3.s[which(metadata3[,1]==3 & bfeats3[,1]==1),2:18], centers=2, nstart=25)
layout(matrix(1:2, ncol=2))
scatterplot3d(bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==1),1],
bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==1),2],
bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==1),3],
angle=20, main="Clustering using all features", xlab="1 PC",
ylab="2 PC", zlab="3 PC", color=colors[bfeats3.top_fun.clust2$cluster], pch=19, cex.lab=1, type="p")
scatterplot3d(bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==1),1],
bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==1),2],
bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==1),3],
angle=20, main="Clustering using only CM-Features", xlab="1 PC",
ylab="2 PC", zlab="3 PC",color=colors[bfeats3.cm.clust2$cluster], cex.lab=1, type="p", pch=19)
bfeats3.cm.clust2 = kmeans(bfeats3.s[which(metadata3[,1]==3 & bfeats3[,1]==1),2:18], centers=2, nstart=25)
layout(matrix(1:2, ncol=2))
scatterplot3d(bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==1),1],
bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==1),2],
bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==1),3],
angle=20, main="Clustering using all features", xlab="1 PC",
ylab="2 PC", zlab="3 PC", color=colors[bfeats3.top_fun.clust2$cluster], pch=19, cex.lab=1, type="p")
scatterplot3d(bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==1),1],
bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==1),2],
bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3 & bfeats3[,1]==1),3],
angle=20, main="Clustering using only CM-Features", xlab="1 PC",
ylab="2 PC", zlab="3 PC",color=colors[bfeats3.cm.clust2$cluster], cex.lab=1, type="p", pch=19)
bfeats3.ela.clust2 = kmeans(bfeats3.s[which(metadata3[,1]==3 & bfeats3[,1]==2),19:58], centers=2, nstart=25)
layout(matrix(1:2, ncol=2))
scatterplot3d(bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),1],
bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),2],
bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),3],
angle=20, main="Clustering using all features", xlab="1 PC",
ylab="2 PC", zlab="3 PC", color=colors[bfeats3.top_ran.clust2$cluster], pch=19, cex.lab=1, type="p")
scatterplot3d(bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),1],
bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),2],
bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),3],
angle=20, main="Clustering using only CM-Features", xlab="1 PC",
ylab="2 PC", zlab="3 PC",color=colors[bfeats3.cm.clust2$cluster], cex.lab=1, type="p", pch=19)
layout(matrix(1:2, ncol=2))
scatterplot3d(bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),1],
bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),2],
bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),3],
angle=20, main="Clustering using all features", xlab="1 PC",
ylab="2 PC", zlab="3 PC", color=colors[bfeats3.top_ran.clust2$cluster], pch=19, cex.lab=1, type="p")
scatterplot3d(bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),1],
bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),2],
bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),3],
angle=20, main="Clustering using only CM-Features", xlab="1 PC",
ylab="2 PC", zlab="3 PC",color=colors[bfeats3.ela.clust2$cluster], cex.lab=1, type="p", pch=19)
scatterplot3d(bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),1],
bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),2],
bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),3],
angle=0, main="Clustering using all features", xlab="1 PC",
ylab="2 PC", zlab="3 PC", color=colors[bfeats3.top_ran.clust2$cluster], pch=19, cex.lab=1, type="p")
scatterplot3d(bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),1],
bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),2],
bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),3],
angle=340, main="Clustering using all features", xlab="1 PC",
ylab="2 PC", zlab="3 PC", color=colors[bfeats3.top_ran.clust2$cluster], pch=19, cex.lab=1, type="p")
layout(matrix(1:2, ncol=2))
scatterplot3d(bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),1],
bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),2],
bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),3],
angle=340, main="Clustering using all features", xlab="1 PC",
ylab="2 PC", zlab="3 PC", color=colors[bfeats3.top_ran.clust2$cluster], pch=19, cex.lab=1, type="p")
scatterplot3d(bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),1],
bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),2],
bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),3],
angle=340, main="Clustering using only CM-Features", xlab="1 PC",
ylab="2 PC", zlab="3 PC",color=colors[bfeats3.ela.clust2$cluster], cex.lab=1, type="p", pch=19)
bfeats3.ela_ran.clust2 = kmeans(bfeats3.s[which(metadata3[,1]==3 & bfeats3[,1]==2),19:58], centers=2, nstart=25)
layout(matrix(1:2, ncol=2))
scatterplot3d(bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),1],
bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),2],
bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),3],
angle=340, main="Clustering using all features", xlab="1 PC",
ylab="2 PC", zlab="3 PC", color=colors[bfeats3.top_ran.clust2$cluster], pch=19, cex.lab=1, type="p")
scatterplot3d(bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),1],
bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),2],
bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3 & bfeats3[,1]==2),3],
angle=340, main="Clustering using only ELA-Features", xlab="1 PC",
ylab="2 PC", zlab="3 PC",color=colors[bfeats3.ela_ran.clust2$cluster], cex.lab=1, type="p", pch=19)
bfeats3.ela.clust2 = kmeans(bfeats3.s[,19:58], centers=2, nstart=25)
layout(matrix(1:2, ncol=2))
#clusters 96% correct
scatterplot3d(bfeats3.pca_cor.ela$scores[,1],
bfeats3.pca_cor.ela$scores[,2],
bfeats3.pca_cor.ela$scores[,3],
angle=115, main="Clustering using all features", xlab="1 PC",
ylab="2 PC", zlab="3 PC", color=colors[bfeats3.clust2$cluster], pch=19, cex.lab=1, type="p")
#clusters already 83% correctly
scatterplot3d(bfeats3.pca_cor.ela$scores[,1],
bfeats3.pca_cor.ela$scores[,2],
bfeats3.pca_cor.ela$scores[,3],
angle=115, main="Clustering using only ELA-Features", xlab="1 PC",
ylab="2 PC", zlab="3 PC",color=colors[bfeats3.ela.clust2$cluster], cex.lab=1, type="p", pch=19)
require(stats)
sapply(c("average", "single", "complete"),
function(method) plot(hclust(dist(iris[,-5]), method),
hang = -1,
labels = FALSE,
las = 1,
xlab = "",
sub = "",
main = paste("Cluster Dendrogram nn(", method,
" linkage)", sep = ""),
cex = 2, cex.axis = 2, cex.lab = 2, cex.main = 2))
layout(matrix(1:3, ncol=3))
sapply(c("average", "single", "complete"),
function(method) plot(hclust(dist(iris[,-5]), method),
hang = -1,
labels = FALSE,
las = 1,
xlab = "",
sub = "",
main = paste("Cluster Dendrogram nn(", method,
" linkage)", sep = ""),
cex = 2, cex.axis = 2, cex.lab = 2, cex.main = 2))
par(mar = c(0, 5, 4, 2) + 0.1)
layout(matrix(1:3, ncol=3))
sapply(c("average", "single", "complete"),
function(method) plot(hclust(dist(iris[,-5]), method),
hang = -1,
labels = FALSE,
las = 1,
xlab = "",
sub = "",
main = paste("Cluster Dendrogram nn(", method,
" linkage)", sep = ""),
cex = 2, cex.axis = 2, cex.lab = 2, cex.main = 2))
par(mar = c(0, 5, 4, 2) + 0.1)
layout(matrix(1:3, ncol=3))
sapply(c("average", "single", "complete"),
function(method) plot(hclust(dist(iris[,-5]), method),
hang = -1,
labels = FALSE,
las = 1,
xlab = "",
sub = "",
main = paste("Cluster Dendrogram nn(", method,
" linkage)", sep = ""),
cex = 1, cex.axis = 1, cex.lab = 1, cex.main = 1))
par(mar = c(0, 5, 4, 2) + 0.1)
layout(matrix(1:6, ncol=3))
sapply(c("average", "single", "complete"),
function(method) plot(hclust(dist(iris[,-5]), method),
hang = -1,
labels = FALSE,
las = 1,
xlab = "",
sub = "",
main = paste("Cluster Dendrogram nn(", method,
" linkage)", sep = ""),
cex = 1, cex.axis = 1, cex.lab = 1, cex.main = 1))
aggl_dend.custom <- function(data, methods=c("single", "complete", "average")) {
#set margin settings and layout
par(mar = c(0, 5, 4, 2) + 0.1)
layout(matrix(1:6, ncol=3))
#create dendrograms applying different methods
sapply(methods,
function(x) plot(hclust(dist(data), x),
hang = -1,
labels = FALSE,
las = 1,
xlab = "",
sub = "",
main = paste("Cluster Dendrogram(" , x,
" linkage)"),
cex = 1, cex.axis = 1, cex.lab = 1, cex.main = 1))
}
aggl_dend.custom(iris[,-5])
aggl_dend.custom(iris[,-5])
aggl_dend.custom(iris[,1:2])
?hclust
#custom function for creating dendrograms with agglomerative clustering to the
#methods defind in the parameter settings
aggl_dend.custom <- function(data, methods=c("single", "complete", "average", "centroid", "ward.D", "ward.D2")) {
#set margin settings and layout
par(mar = c(0, 5, 4, 2) + 0.1)
layout(matrix(1:6, ncol=3, byrow=TRUE))
#create dendrograms applying different methods
sapply(methods,
function(x) plot(hclust(dist(data), x),
hang = -1,
labels = FALSE,
las = 1,
xlab = "",
sub = "",
main = paste("Cluster Dendrogram(" , x,
" linkage)"),
cex = 1, cex.axis = 1, cex.lab = 1, cex.main = 1))
}
aggl_dend.custom(iris[,1:2])
aggl_dend.custom(bfeats3[,2:58])
aggl_dend.custom <- function(data, methods=c("single", "complete", "average", "centroid", "ward.D", "ward.D2")) {
#set margin settings and layout
par(mar = c(0, 5, 4, 2) + 0.1)
layout(matrix(1:6, ncol=3, byrow=TRUE))
#create dendrograms applying different methods
sapply(methods,
function(x) plot(hclust(dist(data), x),
hang = -1,
labels = FALSE,
las = 1,
xlab = "",
sub = "",
main = paste("Cluster Dendrogram(", x,
" linkage)"),
cex = 1, cex.axis = 1, cex.lab = 1, cex.main = 1))
}
aggl_dend.custom(bfeats3[which(metadata3[,1]==3 & bfeats3[,1]==1),2:58])
aggl_dend.custom(bfeats3[which(metadata3[,1]==3 & bfeats3[,1]==2),2:58])
aggl_dend.custom(bfeats3[which(metadata3[,1]==3 & bfeats3[,1]==1),2:18])
aggl_dend.custom(bfeats3[which(metadata3[,1]==3 & bfeats3[,1]==2),19:58])
aggl_dend.custom(bfeats3[which(metadata3[,1]==3 & bfeats3[,1]==1),19:58])
aggl_dend.custom(bfeats3[which(metadata3[,1]==3),19:58])
load("../3-DataPreprocessing.RData")
require(cluster)
dv = diana(bfeats3[1:10,2:3], diss=FALSE, metric="euclidean")
dv
groups = cutree(as.hclust(dv), k=2)
plot(dv)
dv = diana(bfeats3[1:10,2:5], diss=FALSE, metric="euclidean")
plot(dv)
dv = diana(bfeats3[1:100,2:5], diss=FALSE, metric="euclidean")
plot(dv)
dv = diana(bfeats3[1:1000,2:5], diss=FALSE, metric="euclidean")
plot(dv)
groups = cutree(as.hclust(dv), k=2)
groups
dv = diana(bfeats3[1:100,2:18], diss=FALSE, metric="euclidean")
plot(dv)
dv = diana(bfeats3[1:500,2:18], diss=FALSE, metric="euclidean")
plot(dv)
dv = diana(bfeats3[1:500,19:58], diss=FALSE, metric="euclidean")
plot(dv)
dv = diana(bfeats3[1:1000,19:58], diss=FALSE, metric="euclidean")
plot(dv)
dv = diana(bfeats3[1:1500,19:58], diss=FALSE, metric="euclidean")
plot(dv)
layout(matrix(1:2, ncol=2))
scatterplot3d(bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3& bfeats3[,1]==2),1],
bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3& bfeats3[,1]==2),2],
bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3& bfeats3[,1]==2),3],
angle=80, main="Agglomerative Clustering (4 clusters)", xlab="1 PC",
ylab="2 PC", zlab="3 PC", color=colors[bfeats3.block3.ran.aggl.av$group],pch=19)
scatterplot3d(bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3& bfeats3[,1]==2),1],
bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3& bfeats3[,1]==2),2],
bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3& bfeats3[,1]==2),3],
angle=80, main="KMeans Algorithm (2 clusters)", xlab="1 PC",
ylab="2 PC", zlab="3 PC", color=colors[bfeats3.ela_ran.clust2$cluster],pch=19)
require(scatterplot3d)
layout(matrix(1:2, ncol=2))
scatterplot3d(bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3& bfeats3[,1]==2),1],
bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3& bfeats3[,1]==2),2],
bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3& bfeats3[,1]==2),3],
angle=80, main="Agglomerative Clustering (4 clusters)", xlab="1 PC",
ylab="2 PC", zlab="3 PC", color=colors[bfeats3.block3.ran.aggl.av$group],pch=19)
scatterplot3d(bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3& bfeats3[,1]==2),1],
bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3& bfeats3[,1]==2),2],
bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3& bfeats3[,1]==2),3],
angle=80, main="KMeans Algorithm (2 clusters)", xlab="1 PC",
ylab="2 PC", zlab="3 PC", color=colors[bfeats3.ela_ran.clust2$cluster],pch=19)
bfeats3.block3.ran.aggl.av =  hclust(dist(bfeats3[which(metadata3[,1]==3& bfeats3[,1]==2),19:58]), method="ward.D")
bfeats3.block3.ran.aggl.av$group = cutree(bfeats3.block3.ran.aggl.av, k=4)
layout(matrix(1:2, ncol=2))
scatterplot3d(bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3& bfeats3[,1]==2),1],
bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3& bfeats3[,1]==2),2],
bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3& bfeats3[,1]==2),3],
angle=80, main="Agglomerative Clustering (4 clusters)", xlab="1 PC",
ylab="2 PC", zlab="3 PC", color=colors[bfeats3.block3.ran.aggl.av$group],pch=19)
scatterplot3d(bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3& bfeats3[,1]==2),1],
bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3& bfeats3[,1]==2),2],
bfeats3.pca_cor.ela$scores[which(metadata3[,1]==3& bfeats3[,1]==2),3],
angle=80, main="KMeans Algorithm (2 clusters)", xlab="1 PC",
ylab="2 PC", zlab="3 PC", color=colors[bfeats3.ela_ran.clust2$cluster],pch=19)
dv = diana(bfeats3[1:500,2:58], diss=FALSE, metric="euclidean")
dv = diana(bfeats3[1:1000,2:58], diss=FALSE, metric="euclidean")
pairs_noreg.custom <- function(x, m, color=colors[1], legend.title="no", legend.text=NULL, legend.col=NULL,
pch=19, legend.pch = 19) {
#use full window for legend
par(xpd=TRUE)
oma = c(4,4,6,6)
#different margins in case of legend
if(legend.title != "no") {
oma = c(4,4,6,12)
}
#plot the scatterplots
pairs(x, panel = function (x, y, ...) {
points(x, y, ...)
#include correlation coefficients in upper panel and histograms on diagonal
}, pch=pch, diag.panel=panel.hist2, main=m, col=color, oma=oma)
#put legend
#only if legend required
if(legend.title != "no") {
legend("right",legend=legend.text, col=legend.col, pch=legend.pch, title=legend.title, cex=0.8)
}
}
bfeats3.pca_cor = princomp(bfeats3[,-c(1,49)], cor=TRUE, scores=TRUE)
bfeats3.clust2 = kmeans(bfeats3.s, centers=2, nstart=25)
pairs_noreg.custom(bfeats3.pca_cor$scores[,1:6], m="Scatterplot on PCs (2 clusters)", col=colors[bfeats3.clust2$cluster],
legend.title="Cluster",
legend.text=c("1", "2"), legend.col=colors[1:2])
bfeats3.clust2 = kmeans(bfeats3.s, centers=2, nstart=25)
bfeats3.s = sweep(bfeats3, 2, sapply(bfeats3, function(x) diff(range(x))), FUN='/')
bfeats3.clust2 = kmeans(bfeats3.s, centers=2, nstart=25)
pairs_noreg.custom(bfeats3.pca_cor$scores[,1:6], m="Scatterplot on PCs (2 clusters)", col=colors[bfeats3.clust2$cluster],
legend.title="Cluster",
legend.text=c("1", "2"), legend.col=colors[1:2])
require(cluster)
dv = diana(bfeats3[1:1000,2:58], diss=FALSE, metric="euclidean")
plot(dv)
dv$cluster = cutree(as.hclust(dv), k=2)
pairs_noreg.custom(bfeats3.pca_cor$scores[,1:6], m="Scatterplot on PCs (2 clusters)", col=colors[dv$cluster],
legend.title="Cluster",
legend.text=c("1", "2"), legend.col=colors[1:2])
dv$cluster = cutree(as.hclust(dv), k=3)
pairs_noreg.custom(bfeats3.pca_cor$scores[,1:6], m="Scatterplot on PCs (2 clusters)", col=colors[dv$cluster],
legend.title="Cluster",
legend.text=c("1", "2"), legend.col=colors[1:2])
scatterplot3d.custom(bfeats3.pca_cor$scores[,1], bfeats3.pca_cor$scores[,2], bfeats3.pca_cor$scores[,3],
angle=75, main="3D Scatterplot on 1., 2., 3. PC (2 clusters)", xlab="1 PC",
ylab="2 PC", zlab="3 PC", col=colors[dv$cluster], legend.title="Cluster",
legend.text=c("1", "2"), legend.col=colors[c(1,2)])
pairs_noreg.custom(bfeats3.pca_cor$scores[1:1000,1:6], m="Scatterplot on PCs (2 clusters)", col=colors[dv$cluster],
legend.title="Cluster",
legend.text=c("1", "2"), legend.col=colors[1:2])
scatterplot3d.custom(bfeats3.pca_cor$scores[1:1000,1], bfeats3.pca_cor$scores[1:1000,2], bfeats3.pca_cor$scores[1:1000,3],
angle=75, main="3D Scatterplot on 1., 2., 3. PC (2 clusters)", xlab="1 PC",
ylab="2 PC", zlab="3 PC", col=colors[dv$cluster], legend.title="Cluster",
legend.text=c("1", "2"), legend.col=colors[c(1,2)])
plot(dv)
dv = diana(bfeats3[1:1000,2:18], diss=FALSE, metric="euclidean")
dv$cluster = cutree(as.hclust(dv), k=2)
pairs_noreg.custom(bfeats3.pca_cor$scores[1:1000,1:6], m="Scatterplot on PCs (2 clusters)", col=colors[dv$cluster],
legend.title="Cluster",
legend.text=c("1", "2"), legend.col=colors[1:2])
scatterplot3d.custom(bfeats3.pca_cor$scores[1:1000,1], bfeats3.pca_cor$scores[1:1000,2], bfeats3.pca_cor$scores[1:1000,3],
angle=75, main="3D Scatterplot on 1., 2., 3. PC (2 clusters)", xlab="1 PC",
ylab="2 PC", zlab="3 PC", col=colors[dv$cluster], legend.title="Cluster",
legend.text=c("1", "2"), legend.col=colors[c(1,2)])
