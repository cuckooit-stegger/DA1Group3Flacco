print(lambda)
#after transformation
hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
qqnorm(tr, pch=19)
qqline(tr, lwd=2, col="red")
})
View(pfeats)
pfeats = bfeats[which(metadata[,5]==1 & metadata[,6]==1),]
pvar0feats = which(sapply(1:length(pfeats), function(x) {var(pfeats[,x])}) == 0)
pfeats = pfeats[,-pvar0feats]
which(sapply(1:length(pfeats), function(x){shapiro.test(as.numeric(pfeats[,x]))$p.value})>0.01)
sapply(1:length(pfeats), function(x){shapiro.test(as.numeric(pfeats[,x]))$p.value})
layout(matrix(1:6, ncol=3, nrow=2))
sapply(4:4, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-50,10,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(lambda)
#after transformation
hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
qqnorm(tr, pch=19)
qqline(tr, lwd=2, col="red")
})
layout(matrix(1:6, ncol=3, nrow=2))
sapply(3:3, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-6,6,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(lambda)
#after transformation
hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
qqnorm(tr, pch=19)
qqline(tr, lwd=2, col="red")
})
sapply(2:6, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-6,6,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(lambda)
#after transformation
hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
qqnorm(tr, pch=19)
qqline(tr, lwd=2, col="red")
})
par(mar=c(8,5,5,5))
layout(matrix(1:10, ncol=5, nrow=2))
sapply(1:5, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-6,6,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(lambda)
#after transformation
hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
qqnorm(tr, pch=19)
qqline(tr, lwd=2, col="red")
})
layout(matrix(1:10, ncol=5, nrow=2))
sapply(1:5, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-10,6,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(lambda)
#after transformation
hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
qqnorm(tr, pch=19)
qqline(tr, lwd=2, col="red")
})
layout(matrix(1:10, ncol=5, nrow=2))
sapply(1:5, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-20,6,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(lambda)
#after transformation
hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
qqnorm(tr, pch=19)
qqline(tr, lwd=2, col="red")
})
layout(matrix(1:6, ncol=5, nrow=2))
sapply(1:5, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-20,6,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(lambda)
#after transformation
hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
qqnorm(tr, pch=19)
qqline(tr, lwd=2, col="red")
})
layout(matrix(1:6, ncol=5, nrow=2))
sapply(2:11, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-6,6,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(lambda)
#after transformation
hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
qqnorm(tr, pch=19)
qqline(tr, lwd=2, col="red")
})
layout(matrix(1:10, ncol=5, nrow=2))
sapply(2:11, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-15,15,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(lambda)
#after transformation
hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
qqnorm(tr, pch=19)
qqline(tr, lwd=2, col="red")
})
layout(matrix(1:10, ncol=5, nrow=2))
sapply(2:11, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-10,10,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(lambda)
#after transformation
hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
qqnorm(tr, pch=19)
qqline(tr, lwd=2, col="red")
})
layout(matrix(1:10, ncol=5, nrow=2))
sapply(12:17, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-10,10,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(lambda)
#after transformation
hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
qqnorm(tr, pch=19)
qqline(tr, lwd=2, col="red")
})
par(mar=c(8,5,5,5))
View(pfeats)
pfeats = bfeats[which(metadata[,6]==1),]
pvar0feats = which(sapply(1:length(pfeats), function(x) {var(pfeats[,x])}) == 0)
pfeats = pfeats[,-pvar0feats]
which(sapply(1:length(pfeats), function(x){shapiro.test(as.numeric(pfeats[,x]))$p.value})>0.01)
sapply(1:length(pfeats), function(x){shapiro.test(as.numeric(pfeats[,x]))$p.value})
View(pfeats)
layout(matrix(1:10, ncol=5, nrow=2))
sapply(12:17, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-10,10,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(lambda)
#after transformation
hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
qqnorm(tr, pch=19)
qqline(tr, lwd=2, col="red")
})
layout(matrix(1:10, ncol=5, nrow=2))
sapply(2:11, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-10,10,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(lambda)
#after transformation
hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
qqnorm(tr, pch=19)
qqline(tr, lwd=2, col="red")
})
which(metadata[,5]==!)
which(metadata[,5]==1)
which(metadata[,5]==1)
which(metadata[,5]==2)
bfeats[c(1,21,41,61,81),]
bfeats[c(1,21,41,61,81),]
which(metadata[,1]==3)
bfeats[c(1,1001,2001),]
which(metadata[,4]==20)
metadata[c(1,101,201),]
bfeats[c(1,101,201,301),]
metadata[c(1,21,41,61,81),]
metadata[c(1,21,41,61,81, 2, 22, 42,62,82),]
bfeats[c(1,21,41,61,81, 2, 22, 42,62,82),]
bfeats[c(1,21,41,61,81, 101, 121, 141,161,181),]
pfeats = bfeats[which(metadata[,6]==1 & metadata[,1]==3),]
pvar0feats = which(sapply(1:length(pfeats), function(x) {var(pfeats[,x])}) == 0)
pfeats = pfeats[,-pvar0feats]
which(sapply(1:length(pfeats), function(x){shapiro.test(as.numeric(pfeats[,x]))$p.value})>0.01)
sapply(1:length(pfeats), function(x){shapiro.test(as.numeric(pfeats[,x]))$p.value})
sapply(2:11, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-10,10,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(lambda)
#after transformation
#hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
#qqnorm(tr, pch=19)
#qqline(tr, lwd=2, col="red")
})
sapply(7:59, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-10,10,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(lambda)
#after transformation
#hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
#qqnorm(tr, pch=19)
#qqline(tr, lwd=2, col="red")
})
sapply(7:59, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-7,7,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(lambda)
#after transformation
#hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
#qqnorm(tr, pch=19)
#qqline(tr, lwd=2, col="red")
})
sapply(7:59, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-7,7,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(lambda)
print(shapiro.test(tr)$p.value)
#after transformation
#hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
#qqnorm(tr, pch=19)
#qqline(tr, lwd=2, col="red")
})
sapply(7:59, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-7,7,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(shapiro.test(pfeats[,x])$p.value)
print(shapiro.test(tr)$p.value)
#after transformation
#hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
#qqnorm(tr, pch=19)
#qqline(tr, lwd=2, col="red")
})
sapply(2:59, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-7,7,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(shapiro.test(pfeats[,x])$p.value)
print(shapiro.test(tr)$p.value)
#after transformation
#hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
#qqnorm(tr, pch=19)
#qqline(tr, lwd=2, col="red")
})
sapply(2:59, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-7,7,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(x)
print(shapiro.test(pfeats[,x])$p.value)
print(shapiro.test(tr)$p.value)
#after transformation
#hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
#qqnorm(tr, pch=19)
#qqline(tr, lwd=2, col="red")
})
pfeats[,11]
pfeats[,10]
pfeats[,12]
sapply(11:11, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-7,7,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(x)
print(shapiro.test(pfeats[,x])$p.value)
print(shapiro.test(tr)$p.value)
#after transformation
#hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
#qqnorm(tr, pch=19)
#qqline(tr, lwd=2, col="red")
})
sapply(12:59, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-7,7,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(x)
print(shapiro.test(pfeats[,x])$p.value)
print(shapiro.test(tr)$p.value)
#after transformation
#hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
#qqnorm(tr, pch=19)
#qqline(tr, lwd=2, col="red")
})
sapply(13:59, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-7,7,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(x)
print(shapiro.test(pfeats[,x])$p.value)
print(shapiro.test(tr)$p.value)
#after transformation
#hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
#qqnorm(tr, pch=19)
#qqline(tr, lwd=2, col="red")
})
sapply(14:59, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-7,7,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(x)
print(shapiro.test(pfeats[,x])$p.value)
print(shapiro.test(tr)$p.value)
#after transformation
#hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
#qqnorm(tr, pch=19)
#qqline(tr, lwd=2, col="red")
})
sapply(15:59, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-7,7,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(x)
print(shapiro.test(pfeats[,x])$p.value)
print(shapiro.test(tr)$p.value)
#after transformation
#hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
#qqnorm(tr, pch=19)
#qqline(tr, lwd=2, col="red")
})
#layout(matrix(1:10, ncol=5, nrow=2))
sapply(21:59, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-7,7,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(x)
print(shapiro.test(pfeats[,x])$p.value)
print(shapiro.test(tr)$p.value)
#after transformation
#hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
#qqnorm(tr, pch=19)
#qqline(tr, lwd=2, col="red")
})
sapply(31:59, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-7,7,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(x)
print(shapiro.test(pfeats[,x])$p.value)
print(shapiro.test(tr)$p.value)
#after transformation
#hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
#qqnorm(tr, pch=19)
#qqline(tr, lwd=2, col="red")
})
sapply(38:59, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-7,7,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(x)
print(shapiro.test(pfeats[,x])$p.value)
print(shapiro.test(tr)$p.value)
#after transformation
#hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
#qqnorm(tr, pch=19)
#qqline(tr, lwd=2, col="red")
})
sapply(45:59, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-7,7,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(x)
print(shapiro.test(pfeats[,x])$p.value)
print(shapiro.test(tr)$p.value)
#after transformation
#hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
#qqnorm(tr, pch=19)
#qqline(tr, lwd=2, col="red")
})
sapply(47:59, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-7,7,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(x)
print(shapiro.test(pfeats[,x])$p.value)
print(shapiro.test(tr)$p.value)
#after transformation
#hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
#qqnorm(tr, pch=19)
#qqline(tr, lwd=2, col="red")
})
sapply(58:59, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-7,7,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(x)
print(shapiro.test(pfeats[,x])$p.value)
print(shapiro.test(tr)$p.value)
#after transformation
#hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
#qqnorm(tr, pch=19)
#qqline(tr, lwd=2, col="red")
})
pfeats = bfeats[which(metadata[,6]==1 & metadata[,1]==3),]
sapply(2:59, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-7,7,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(x)
print(shapiro.test(pfeats[,x])$p.value)
print(shapiro.test(tr)$p.value)
#after transformation
#hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
#qqnorm(tr, pch=19)
#qqline(tr, lwd=2, col="red")
})
sapply(15:59, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-7,7,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(x)
print(shapiro.test(pfeats[,x])$p.value)
print(shapiro.test(tr)$p.value)
#after transformation
#hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
#qqnorm(tr, pch=19)
#qqline(tr, lwd=2, col="red")
})
sapply(21:59, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-7,7,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(x)
print(shapiro.test(pfeats[,x])$p.value)
print(shapiro.test(tr)$p.value)
#after transformation
#hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
#qqnorm(tr, pch=19)
#qqline(tr, lwd=2, col="red")
})
sapply(31:59, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-7,7,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(x)
print(shapiro.test(pfeats[,x])$p.value)
print(shapiro.test(tr)$p.value)
#after transformation
#hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
#qqnorm(tr, pch=19)
#qqline(tr, lwd=2, col="red")
})
sapply(38:59, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-7,7,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(x)
print(shapiro.test(pfeats[,x])$p.value)
print(shapiro.test(tr)$p.value)
#after transformation
#hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
#qqnorm(tr, pch=19)
#qqline(tr, lwd=2, col="red")
})
sapply(45:59, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-7,7,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(x)
print(shapiro.test(pfeats[,x])$p.value)
print(shapiro.test(tr)$p.value)
#after transformation
#hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
#qqnorm(tr, pch=19)
#qqline(tr, lwd=2, col="red")
})
sapply(47:59, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-7,7,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(x)
print(shapiro.test(pfeats[,x])$p.value)
print(shapiro.test(tr)$p.value)
#after transformation
#hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
#qqnorm(tr, pch=19)
#qqline(tr, lwd=2, col="red")
})
sapply(51:59, function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-7,7,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(x)
print(shapiro.test(pfeats[,x])$p.value)
print(shapiro.test(tr)$p.value)
#after transformation
#hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
#qqnorm(tr, pch=19)
#qqline(tr, lwd=2, col="red")
})
c(2:10,13)
sapply(c(2:10, 15:19, 21:29, 31:36, 45, 47:49, 51:56, 58:59), function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-7,7,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(x)
print(shapiro.test(pfeats[,x])$p.value)
print(shapiro.test(tr)$p.value)
#after transformation
#hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
#qqnorm(tr, pch=19)
#qqline(tr, lwd=2, col="red")
})
sapply(c(59), function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-7,7,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(x)
print(shapiro.test(pfeats[,x])$p.value)
print(shapiro.test(tr)$p.value)
#after transformation
#hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
#qqnorm(tr, pch=19)
#qqline(tr, lwd=2, col="red")
})
layout(matrix(1:10, ncol=5, nrow=2))
sapply(c(2:10, 15:19, 21:29, 31:36, 45, 47:49, 51:56, 59), function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-7,7,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(x)
print(shapiro.test(pfeats[,x])$p.value)
print(shapiro.test(tr)$p.value)
#after transformation
hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 2), col='cyan', cex.main=2, cex.lab=2, ylab='')
qqnorm(tr, pch=19)
qqline(tr, lwd=2, col="red")
})
layout(matrix(1:10, ncol=5, nrow=2))
sapply(c(2:10, 15:19, 21:29, 31:36, 45, 47:49, 51:56, 59), function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-7,7,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(x)
print(shapiro.test(pfeats[,x])$p.value)
print(shapiro.test(tr)$p.value)
#after transformation
hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 6), col='cyan', cex.main=2, cex.lab=2, ylab='')
qqnorm(tr, pch=19)
qqline(tr, lwd=2, col="red")
})
pfeats = bfeats[which(metadata[,6]==2 & metadata[,1]==5),]
layout(matrix(1:10, ncol=5, nrow=2))
sapply(c(2:10, 15:19, 21:29, 31:36, 45, 47:49, 51:56, 59), function(x) {
lambda <- boxcoxnc(as.numeric(pfeats[,x]), method='sw', plotit=FALSE, lam=seq(-7,7,0.01))$result[[1]]
tr <- (pfeats[,x]^{lambda}-1)/lambda
print(x)
print(shapiro.test(pfeats[,x])$p.value)
print(shapiro.test(tr)$p.value)
#after transformation
hist(tr, main = x, xlab=round(shapiro.test(tr)$p.value, 6), col='cyan', cex.main=2, cex.lab=2, ylab='')
qqnorm(tr, pch=19)
qqline(tr, lwd=2, col="red")
})
