legend.title = "Number of peaks", legend.text = c("20 peaks", "40 peaks", "60 peaks",
"80 peaks", "100 peaks", "120 peaks", "140 peaks", "160 peaks","180 peaks", "200 peaks"),
legend.col=colors[1:10])
bfeats3.pca_fgroups = data.frame(
bfeats3.topology,
princomp(bfeats3.cm_angle, corr=TRUE, scores=TRUE)$scores[,1],
princomp(bfeats3.cm_conv, corr=TRUE, scores=TRUE)$scores[,1],
princomp(bfeats3.cm_grad, corr=TRUE, scores=TRUE)$scores[,1],
princomp(bfeats3.ela_conv, corr=TRUE, scores=TRUE)$scores[,1],
princomp(bfeats3.ela_curv, corr=TRUE, scores=TRUE)$scores[,1],
princomp(bfeats3.ela_local, corr=TRUE, scores=TRUE)$scores[,1])
bfeats3.pca_fgroups = data.frame(
princomp(bfeats3.cm_angle, corr=TRUE, scores=TRUE)$scores[,1],
princomp(bfeats3.cm_conv, corr=TRUE, scores=TRUE)$scores[,1],
princomp(bfeats3.cm_grad, corr=TRUE, scores=TRUE)$scores[,1],
princomp(bfeats3.ela_conv, corr=TRUE, scores=TRUE)$scores[,1],
princomp(bfeats3.ela_curv, corr=TRUE, scores=TRUE)$scores[,1],
princomp(bfeats3.ela_local, corr=TRUE, scores=TRUE)$scores[,1])
summary(princomp(bfeats3.cm_angle, corr=TRUE, scores=TRUE))  #93.30%
summary(princomp(bfeats3.cm_conv, corr=TRUE, scores=TRUE))  #73.38%
summary(princomp(bfeats3.cm_grad, corr=TRUE, scores=TRUE))  #95.55%
summary(princomp(bfeats3.ela_conv, corr=TRUE, scores=TRUE))  #99.99%
summary(princomp(bfeats3.ela_curv, corr=TRUE, scores=TRUE))  #60.06%
summary(princomp(bfeats3.ela_local, corr=TRUE, scores=TRUE))  #99.80%
colnames(princomp_feat_groups) <- c("cm_angle", "cm_conv", "cm_curv", "ela_conv", "ela_curv", "ela_local")
colnames(bfeats3.pca_fgroups) <- c("cm_angle", "cm_conv", "cm_curv", "ela_conv", "ela_curv", "ela_local")
pairs_noreg.custom(bfeats3.pca_fgroups$scores[,1:6], m="Scatterplot on Feature Group-PCs")
pairs_noreg.custom(bfeats3.pca_fgroups[,1:6]$scores[,1], m="Scatterplot on Feature Group-PCs")
pairs_noreg.custom(bfeats3.pca_fgroups[1:6]$scores[,1], m="Scatterplot on Feature Group-PCs")
pairs_noreg.custom(bfeats3.pca_fgroups[1:6]$scores, m="Scatterplot on Feature Group-PCs")
pairs_noreg.custom(bfeats3.pca_fgroups[1:6], m="Scatterplot on Feature Group-PCs")
bfeats3.pca_fgroups[1:6]
str(bfeats3.pca_fgroups[1:6])
pairs_noreg.custom(bfeats3.pca_fgroups[1:6], m="Scatterplot on Feature Group-PCs", col=colors[metadata3[,1]])
pairs_noreg.custom(bfeats3.pca_fgroups[1:6], m="Scatterplot on Feature Group-PCs", col=colors[bfeats3[,1]])
pairs_noreg.custom(bfeats3.pca_fgroups[1:6], m="Scatterplot on Feature Group-PCs", col=colors[bfeats3[,1]],
legend.title = "Topology", legend.text = c("funnel", "random"),
legend.col=colors[1:10])
mds.custom <- function(dist_mat, dim) {
A = -0.5*as.matrix(dist_mat)^2
B = A - outer(rowMeans(A), colMeans(A), "+") + mean(A)
eg = eigen(B)
X = NULL
for(i in 1:dim) {
X = cbind(X, eg$vectors[,i] * sqrt(eg$values[i]))
}
}
mds.custom <- function(dist_mat, dim) {
#calculate A from distance matrix
A = -0.5*as.matrix(dist_mat)^2
#centering the matrix
B = A - outer(rowMeans(A), colMeans(A), "+") + mean(A)
#calculate eigenvalues
eg = eigen(B)
X = NULL
#concatenate eigenvectors and variances
for(i in 1:dim) {
X = cbind(X, eg$vectors[,i] * sqrt(eg$values[i]))
}
}
bfeats3.dist = dist(bfeats3)
?cmdscale
bfeats3.mds = cmdscale(bfeats3.dist, k = 3, eig=TRUE, add = FALSE, x.ret = FALSE)
scatterplot3d.custom(bfeats3.pca_cor$scores[,1], bfeats3.pca_cor$scores[,2], bfeats3.pca_cor$scores[,3],
angle=75, main="3D Scatterplot on 1., 2., 3. PC", xlab="1 PC",
ylab="2 PC", zlab="3 PC",col=colors[1], legend.title="no", legend.col=NULL, legend.text=NULL)
require(scatterplot3d)
scatterplot3d.custom(bfeats3.pca_cor$scores[,1], bfeats3.pca_cor$scores[,2], bfeats3.pca_cor$scores[,3],
angle=75, main="3D Scatterplot on 1., 2., 3. PC", xlab="1 PC",
ylab="2 PC", zlab="3 PC",col=colors[1], legend.title="no", legend.col=NULL, legend.text=NULL)
scatterplot3d.custom(bfeats3.mds$points[,1], bfeats3.mds$points[,2], bfeats3.mds$points[,3],
angle=75, main="3D Scatterplot on 1., 2., 3. PC", xlab="1 PC",
ylab="2 PC", zlab="3 PC",col=colors[1], legend.title="no", legend.col=NULL, legend.text=NULL)
scatterplot3d.custom(bfeats3.pca_cov$scores[,1], bfeats3.pca_cov$scores[,2], bfeats3.pca_cov$scores[,3],
angle=75, main="3D Scatterplot on 1., 2., 3. PC", xlab="1 PC",
ylab="2 PC", zlab="3 PC",col=colors[1], legend.title="no", legend.col=NULL, legend.text=NULL)
bfeats3.dist = dist(cor(bfeats3)
bfeats3.dist = dist(cor(bfeats3))
bfeats3.dist = dist(cor(bfeats3))
bfeats3.mds = cmdscale(bfeats3.dist, k = 3, eig=TRUE, add = FALSE, x.ret = FALSE)
scatterplot3d.custom(bfeats3.mds$points[,1], bfeats3.mds$points[,2], bfeats3.mds$points[,3],
angle=75, main="3D Scatterplot on 1., 2., 3. PC", xlab="1 PC",
ylab="2 PC", zlab="3 PC",col=colors[1], legend.title="no", legend.col=NULL, legend.text=NULL)
bfeats3.dist = dist(as.data.frame(apply(bfeats3, 2, scale)))
bfeats3.mds = cmdscale(bfeats3.dist, k = 3, eig=TRUE, add = FALSE, x.ret = FALSE)
scatterplot3d.custom(bfeats3.mds$points[,1], bfeats3.mds$points[,2], bfeats3.mds$points[,3],
angle=75, main="3D Scatterplot on 1., 2., 3. PC", xlab="1 PC",
ylab="2 PC", zlab="3 PC",col=colors[1], legend.title="no", legend.col=NULL, legend.text=NULL)
scatterplot3d.custom(bfeats3.pca_cov$scores[,1], bfeats3.pca_cov$scores[,2], bfeats3.pca_cov$scores[,3],
angle=75, main="3D Scatterplot on 1., 2., 3. PC", xlab="1 PC",
ylab="2 PC", zlab="3 PC",col=colors[1], legend.title="no", legend.col=NULL, legend.text=NULL)
scatterplot3d.custom(bfeats3.pca_cor$scores[,1], bfeats3.pca_cor$scores[,2], bfeats3.pca_cor$scores[,3],
angle=75, main="3D Scatterplot on 1., 2., 3. PC", xlab="1 PC",
ylab="2 PC", zlab="3 PC",col=colors[1], legend.title="no", legend.col=NULL, legend.text=NULL)
scatterplot3d.custom(bfeats3.mds$points[,1], bfeats3.mds$points[,2], bfeats3.mds$points[,3],
angle=75, main="3D Scatterplot on 1., 2., 3. PC", xlab="1 PC",
ylab="2 PC", zlab="3 PC",col=colors[1], legend.title="no", legend.col=NULL, legend.text=NULL)
bfeats3.dist = dist(bfeats3)
bfeats3.mds = cmdscale(bfeats3.dist, k = 20, eig=TRUE, add = FALSE, x.ret = FALSE)
summary(bfeats3.mds)
summary(bfeats3.mds)$eig
summary(bfeats3.mds$eig)
cumsum(bfeats3.mds$eig)
cumsum(bfeats3.mds$eig[1:20])
scatterplot3d.custom(bfeats3.mds$points[,1], bfeats3.mds$points[,2], bfeats3.mds$points[,3],
angle=75, main="3D Scatterplot on 1., 2., 3. PC", xlab="1 PC",
ylab="2 PC", zlab="3 PC",col=colors[1], legend.title="no", legend.col=NULL, legend.text=NULL)
cumsum(bfeats3.mds$eig[1:20])/sum(bfeats3.mds$eig[1:20])
bfeats3.dist_scale = dist(as.data.frame(apply(bfeats3, 2, scale)))
bfeats3.mds_scale = cmdscale(bfeats3.dist_scale, k = 3, eig=TRUE, add = FALSE, x.ret = FALSE)
cumsum(bfeats3.mds_scale$eig[1:20])/sum(bfeats3.mds_scale$eig[1:20])
summary(bfeats3.pca_cor)
bfeats3.dist = dist(bfeats3[,2:58])
bfeats3.mds = cmdscale(bfeats3.dist, k = 20, eig=TRUE, add = FALSE, x.ret = FALSE)
cumsum(bfeats3.mds$eig[1:20])/sum(bfeats3.mds$eig[1:20])
bfeats3.dist_scale = dist(as.data.frame(apply(bfeats3[,2:58], 2, scale)))
bfeats3.mds_scale = cmdscale(bfeats3.dist_scale, k = 3, eig=TRUE, add = FALSE, x.ret = FALSE)
cumsum(bfeats3.mds_scale$eig[1:20])/sum(bfeats3.mds_scale$eig[1:20])
cumsum(bfeats3.mds_scale$eig[1:20])/sum(bfeats3.mds_scale$eig[1:20])
plot(bfeats3.mds_scale$eig[1:20], type="b", main="Scree diagram MDS", xlab="Component number", ylab="Component value")
plot(bfeats3.mds_scale$eig[1:20], type="b", main="Scree diagram MDS", xlab="Component number", ylab="Component value")
plot(bfeats3.mds_scale$eig[1:20], type="b", main="Scree diagram MDS (elbow)", xlab="Component number", ylab="Component value")
points(6, bfeats3.mds_scale$eig[6], col="red", cex=2.5, lwd=1.5, pch=1)
#biplot
biplot(bfeats3.mds_scale$eig[1:20], main="Biplot of PCA based on cor")
biplot(bfeats3.mds_scale, main="Biplot of PCA based on cor")
bfeats3.mds_custom = mds.custom(bfeats3.dist_scale, 20)
pairs_noreg.custom(bfeats3.mds_scale$points[,1:6], m="Scatterplot on MDS")
bfeats3.mds_scale = cmdscale(bfeats3.dist_scale, k = 20, eig=TRUE, add = FALSE, x.ret = FALSE)
pairs_noreg.custom(bfeats3.mds_scale$points[,1:6], m="Scatterplot on MDS")
pairs_noreg.custom(bfeats3.mds_scale$points[,1:6], m="Scatterplot on MDS", col=colors[metadata3[,1]],
legend.title="Number of blocks",
legend.text=c("3 blocks", "5 blocks", "7 blocks"), legend.col=colors[c(3,5,7)])
pairs_noreg.custom(bfeats3.mds_scale$points[,1:6], m="Scatterplot on PCs", col=colors[metadata3[,4]/20],
legend.title = "Number of peaks", legend.text = c("20 peaks", "40 peaks", "60 peaks",
"80 peaks", "100 peaks", "120 peaks", "140 peaks", "160 peaks","180 peaks", "200 peaks"),
legend.col=colors[1:10])
pairs_noreg.custom(bfeats3.mds_scale$points[,1:6], m="Scatterplot on PCs", col=colors[metadata[,5]],
legend.title = "Prob.seed", legend.text = c("1", "2", "3",
"4", "5"),legend.col=colors[1:5])
pairs_noreg.custom(bfeats3.mds_scale$points[,1:6], m="Scatterplot on PCs", col=colors[metadata[,6]],
legend.title = "Repl", legend.text = c("1", "2", "3",
"4", "5", "6", "7", "8","9", "10"),
legend.col=colors[1:10])
pairs_noreg.custom(bfeats3.mds_scale$points[,1:6], m="Scatterplot on PCs", col=colors[bfeats3[,1]],
legend.title = "Topology", legend.text = c("funnel", "random"),
legend.col=colors[1:10])
scatterplot3d.custom(bfeats3.pca_cor$scores[,1], bfeats3.pca_cor$scores[,2], bfeats3.pca_cor$scores[,3],
angle=75, main="3D Scatterplot on 1., 2., 3. PC", xlab="1 PC",
ylab="2 PC", zlab="3 PC",col=colors[1], legend.title="no", legend.col=NULL, legend.text=NULL)
scatterplot3d.custom(bfeats3.mds_scale$points[,1], bfeats3.mds_scale$points[,2], bfeats3.mds_scale$points[,3],
angle=75, main="3D Scatterplot on 1., 2., 3. PC", xlab="1 PC",
ylab="2 PC", zlab="3 PC",col=colors[1], legend.title="no", legend.col=NULL, legend.text=NULL)
scatterplot3d.custom(bfeats3.mds_scale$points[,1], bfeats3.mds_scale$points[,2], bfeats3.mds_scale$points[,3],
angle=75, main="3D Scatterplot on MDS (3 dim)", xlab="1 dim",
ylab="2 dim", zlab="3 dim",col=colors[1], legend.title="no", legend.col=NULL, legend.text=NULL)
scatterplot3d.custom(bfeats3.pca_cor$scores[,1], bfeats3.pca_cor$scores[,2], bfeats3.pca_cor$scores[,3],
angle=75, main="3D Scatterplot on 1., 2., 3. PC", xlab="1 PC",
ylab="2 PC", zlab="3 PC",col=colors[1], legend.title="no", legend.col=NULL, legend.text=NULL)
layout(matrix(1:2, ncol=2))
layout(matrix(1:2, ncol=2))
scatterplot3d.custom(bfeats3.mds_scale$points[,1], bfeats3.mds_scale$points[,2], bfeats3.mds_scale$points[,3],
angle=75, main="3D Scatterplot on MDS (3 dim)", xlab="1 dim",
ylab="2 dim", zlab="3 dim",col=colors[1], legend.title="no", legend.col=NULL, legend.text=NULL)
scatterplot3d.custom(bfeats3.pca_cor$scores[,1], bfeats3.pca_cor$scores[,2], bfeats3.pca_cor$scores[,3],
angle=75, main="3D Scatterplot on 1., 2., 3. PC", xlab="1 PC",
ylab="2 PC", zlab="3 PC",col=colors[1], legend.title="no", legend.col=NULL, legend.text=NULL)
scatterplot3d_comp.custom <- function(x, y, z, angle, main, xlab, ylab, zlab,
x2, y2, z2, angle2, main2, xlab2, ylab2, zlab2,
col, legend.text, legend.col, legend.title) {
layout(cbind(c(1,2), c(3,4), heights=c(7,1))
scatterplot3d(x, y, z, angle=angle, pch=19, cex.lab=1, type="p", main=main, xlab=xlab,
ylab=ylab, zlab=zlab, color=col)
scatterplot3d(x2, y2, z2, angle=angle2, pch=19, cex.lab=1, type="p", main=main2, xlab=xlab2,
ylab=ylab2, zlab=zlab2, color=col)
par(mar=c(0,0,0,0))
plot.new()
if(legend.title != "no") {
legend('center','groups',legend=legend.text, col=legend.col, pch=19, title=legend.title, bty ="n", horiz=TRUE, cex=0.8)
}
#reset normal settings
layout(matrix(1, ncol=1))
par(mar=c(8,5,5,5))
}
scatterplot3d_comp.custom <- function(x, y, z, angle, main, xlab, ylab, zlab,
x2, y2, z2, angle2, main2, xlab2, ylab2, zlab2,
col, legend.text, legend.col, legend.title) {
layout(cbind(c(1,2), c(3,4), heights=c(7,1))
scatterplot3d(x, y, z, angle=angle, pch=19, cex.lab=1, type="p", main=main, xlab=xlab,
ylab=ylab, zlab=zlab, color=col)
scatterplot3d(x2, y2, z2, angle=angle2, pch=19, cex.lab=1, type="p", main=main2, xlab=xlab2,
ylab=ylab2, zlab=zlab2, color=col)
par(mar=c(0,0,0,0))
plot.new()
if(legend.title != "no") {
legend('center','groups',legend=legend.text, col=legend.col, pch=19, title=legend.title, bty ="n", horiz=TRUE, cex=0.8)
}
#reset normal settings
layout(matrix(1, ncol=1))
par(mar=c(8,5,5,5))
}
scatterplot3d_comp.custom <- function(x, y, z, angle, main, xlab, ylab, zlab,
x2, y2, z2, angle2, main2, xlab2, ylab2, zlab2,
col, legend.text, legend.col, legend.title) {
layout(cbind(c(1,2), c(3,4), heights=c(7,1))
scatterplot3d(x, y, z, angle=angle, pch=19, cex.lab=1, type="p", main=main, xlab=xlab,
ylab=ylab, zlab=zlab, color=col)
scatterplot3d(x2, y2, z2, angle=angle2, pch=19, cex.lab=1, type="p", main=main2, xlab=xlab2,
ylab=ylab2, zlab=zlab2, color=col)
#par(mar=c(0,0,0,0))
#plot.new()
#if(legend.title != "no") {
#   legend('center','groups',legend=legend.text, col=legend.col, pch=19, title=legend.title, bty ="n", horiz=TRUE, cex=0.8)
# }
#reset normal settings
#layout(matrix(1, ncol=1))
#par(mar=c(8,5,5,5))
}
scatterplot3d_comp.custom <- function(x, y, z, angle, main, xlab, ylab, zlab,
x2, y2, z2, angle2, main2, xlab2, ylab2, zlab2,
col, legend.text, legend.col, legend.title) {
layout(cbind(c(1,2), c(3,4)), heights=c(7,1))
scatterplot3d(x, y, z, angle=angle, pch=19, cex.lab=1, type="p", main=main, xlab=xlab,
ylab=ylab, zlab=zlab, color=col)
scatterplot3d(x2, y2, z2, angle=angle2, pch=19, cex.lab=1, type="p", main=main2, xlab=xlab2,
ylab=ylab2, zlab=zlab2, color=col)
#par(mar=c(0,0,0,0))
#plot.new()
#if(legend.title != "no") {
#   legend('center','groups',legend=legend.text, col=legend.col, pch=19, title=legend.title, bty ="n", horiz=TRUE, cex=0.8)
# }
#reset normal settings
#layout(matrix(1, ncol=1))
#par(mar=c(8,5,5,5))
}
scatterplot3d_comp.custom(bfeats3.mds_scale$points[,1], bfeats3.mds_scale$points[,2], bfeats3.mds_scale$points[,3],
angle=75, main="3D Scatterplot on MDS (3 dim)", xlab="1 dim",
ylab="2 dim", zlab="3 dim",
bfeats3.pca_cor$scores[,1], bfeats3.pca_cor$scores[,2], bfeats3.pca_cor$scores[,3],
angle=75, main="3D Scatterplot on 1., 2., 3. PC", xlab="1 PC",
ylab="2 PC", zlab="3 PC",
col=colors[1], legend.title="no", legend.col=NULL, legend.text=NULL)
scatterplot3d_comp.custom(bfeats3.mds_scale$points[,1], bfeats3.mds_scale$points[,2], bfeats3.mds_scale$points[,3],
angle=75, main="3D Scatterplot on MDS (3 dim)", xlab="1 dim",
ylab="2 dim", zlab="3 dim",
x2=bfeats3.pca_cor$scores[,1], y2=bfeats3.pca_cor$scores[,2], z2=bfeats3.pca_cor$scores[,3],
angle2=75, main2="3D Scatterplot on 1., 2., 3. PC", xlab2="1 PC",
ylab2="2 PC", zlab2="3 PC",
col=colors[1], legend.title="no", legend.col=NULL, legend.text=NULL)
scatterplot3d_comp.custom <- function(x, y, z, angle, main, xlab, ylab, zlab,
x2, y2, z2, angle2, main2, xlab2, ylab2, zlab2,
col, legend.text, legend.col, legend.title) {
layout(cbind(c(1,2), c(3,4)), heights=c(7,1))
scatterplot3d(x, y, z, angle=angle, pch=19, cex.lab=1, type="p", main=main, xlab=xlab,
ylab=ylab, zlab=zlab, color=col)
par(mar=c(0,0,0,0))
plot.new()
if(legend.title != "no") {
legend('center','groups',legend=legend.text, col=legend.col, pch=19, title=legend.title, bty ="n", horiz=TRUE, cex=0.8)
}
scatterplot3d(x2, y2, z2, angle=angle2, pch=19, cex.lab=1, type="p", main=main2, xlab=xlab2,
ylab=ylab2, zlab=zlab2, color=col)
par(mar=c(0,0,0,0))
plot.new()
if(legend.title != "no") {
legend('center','groups',legend=legend.text, col=legend.col, pch=19, title=legend.title, bty ="n", horiz=TRUE, cex=0.8)
}
#reset normal settings
layout(matrix(1, ncol=1))
par(mar=c(8,5,5,5))
}
scatterplot3d_comp.custom(bfeats3.mds_scale$points[,1], bfeats3.mds_scale$points[,2], bfeats3.mds_scale$points[,3],
angle=75, main="3D Scatterplot on MDS (3 dim)", xlab="1 dim",
ylab="2 dim", zlab="3 dim",
x2=bfeats3.pca_cor$scores[,1], y2=bfeats3.pca_cor$scores[,2], z2=bfeats3.pca_cor$scores[,3],
angle2=75, main2="3D Scatterplot on 1., 2., 3. PC", xlab2="1 PC",
ylab2="2 PC", zlab2="3 PC",
col=colors[1], legend.title="no", legend.col=NULL, legend.text=NULL)
scatterplot3d_comp.custom <- function(x, y, z, angle, main, xlab, ylab, zlab,
x2, y2, z2, angle2, main2, xlab2, ylab2, zlab2,
col) {
layout(matrix(1:2, ncol=2))
scatterplot3d(x, y, z, angle=angle, pch=19, cex.lab=1, type="p", main=main, xlab=xlab,
ylab=ylab, zlab=zlab, color=col)
scatterplot3d(x2, y2, z2, angle=angle2, pch=19, cex.lab=1, type="p", main=main2, xlab=xlab2,
ylab=ylab2, zlab=zlab2, color=col)
#reset normal settings
layout(matrix(1, ncol=1))
}
scatterplot3d(bfeats3.mds_scale$points[,1], bfeats3.mds_scale$points[,2], bfeats3.mds_scale$points[,3],
angle=75, main="3D Scatterplot on MDS (3 dim)", xlab="1 dim",
ylab="2 dim", zlab="3 dim", col=colors[1])
scatterplot3d(bfeats3.mds_scale$points[,1], bfeats3.mds_scale$points[,2], bfeats3.mds_scale$points[,3],
angle=75, main="3D Scatterplot on MDS (3 dim)", xlab="1 dim",
ylab="2 dim", zlab="3 dim", col=colors[1], pch=19, cex.lab=1, type="p")
scatterplot3d(bfeats3.mds_scale$points[,1], bfeats3.mds_scale$points[,2], bfeats3.mds_scale$points[,3],
angle=75, main="3D Scatterplot on MDS (3 dim)", xlab="1 dim",
ylab="2 dim", zlab="3 dim", color=colors[1], pch=19, cex.lab=1, type="p")
scatterplot3d(bfeats3.mds_scale$points[,1], bfeats3.mds_scale$points[,2], bfeats3.mds_scale$points[,3],
angle=75, main="3D Scatterplot on MDS (3 dim)", xlab="1 dim",
ylab="2 dim", zlab="3 dim", color=colors[1], pch=19, cex.lab=1, type="p")
layout(matrix(1:2, ncol=2))
scatterplot3d(bfeats3.mds_scale$points[,1], bfeats3.mds_scale$points[,2], bfeats3.mds_scale$points[,3],
angle=75, main="3D Scatterplot on MDS (3 dim)", xlab="1 dim",
ylab="2 dim", zlab="3 dim", color=colors[1], pch=19, cex.lab=1, type="p")
scatterplot3d(bfeats3.pca_cor$scores[,1], bfeats3.pca_cor$scores[,2], bfeats3.pca_cor$scores[,3],
angle=75, main="3D Scatterplot on 1., 2., 3. PC", xlab="1 PC",
ylab="2 PC", zlab="3 PC",color=colors[1])
layout(matrix(1:2, ncol=2))
scatterplot3d(bfeats3.mds_scale$points[,1], bfeats3.mds_scale$points[,2], bfeats3.mds_scale$points[,3],
angle=75, main="3D Scatterplot on MDS (3 dim)", xlab="1 dim",
ylab="2 dim", zlab="3 dim", color=colors[1], pch=19, cex=0.5, type="p")
scatterplot3d(bfeats3.pca_cor$scores[,1], bfeats3.pca_cor$scores[,2], bfeats3.pca_cor$scores[,3],
angle=75, main="3D Scatterplot on 1., 2., 3. PC", xlab="1 PC",
ylab="2 PC", zlab="3 PC",color=colors[1])
layout(matrix(1:2, ncol=2))
scatterplot3d(bfeats3.mds_scale$points[,1], bfeats3.mds_scale$points[,2], bfeats3.mds_scale$points[,3],
angle=75, main="3D Scatterplot on MDS (3 dim)", xlab="1 dim",
ylab="2 dim", zlab="3 dim", color=colors[1], pch=19, cex=0.5, type="p")
scatterplot3d(bfeats3.pca_cor$scores[,1], bfeats3.pca_cor$scores[,2], bfeats3.pca_cor$scores[,3],
angle=75, main="3D Scatterplot on 1., 2., 3. PC", xlab="1 PC",
ylab="2 PC", zlab="3 PC",color=colors[1])
layout(matrix(1:2, ncol=2))
scatterplot3d(bfeats3.mds_scale$points[,1], bfeats3.mds_scale$points[,2], bfeats3.mds_scale$points[,3],
angle=75, main="3D Scatterplot on MDS (3 dim)", xlab="1 dim",
ylab="2 dim", zlab="3 dim", color=colors[1], pch=19, cex=0.5, type="p")
scatterplot3d(bfeats3.pca_cor$scores[,1], bfeats3.pca_cor$scores[,2], bfeats3.pca_cor$scores[,3],
angle=75, main="3D Scatterplot on 1., 2., 3. PC", xlab="1 PC",
ylab="2 PC", zlab="3 PC",color=colors[1])
layout(matrix(1:2, ncol=2))
scatterplot3d(bfeats3.mds_scale$points[,1], bfeats3.mds_scale$points[,2], bfeats3.mds_scale$points[,3],
angle=75, main="3D Scatterplot on MDS (3 dim)", xlab="1 dim",
ylab="2 dim", zlab="3 dim", color=colors[1], pch=19, cex.lab=1, type="p")
scatterplot3d(bfeats3.pca_cor$scores[,1], bfeats3.pca_cor$scores[,2], bfeats3.pca_cor$scores[,3],
angle=75, main="3D Scatterplot on 1., 2., 3. PC", xlab="1 PC",
ylab="2 PC", zlab="3 PC",color=colors[1], cex.lab=1, type="p", pch=19)
layout(matrix(1:2, ncol=2))
scatterplot3d(bfeats3.mds_scale$points[,1], bfeats3.mds_scale$points[,2], bfeats3.mds_scale$points[,3],
angle=75, main="3D Scatterplot on MDS (3 dim)", xlab="1 dim",
ylab="2 dim", zlab="3 dim", color=colors[metadata[,1]], pch=19, cex.lab=1, type="p")
scatterplot3d(bfeats3.pca_cor$scores[,1], bfeats3.pca_cor$scores[,2], bfeats3.pca_cor$scores[,3],
angle=75, main="3D Scatterplot on 1., 2., 3. PC", xlab="1 PC",
ylab="2 PC", zlab="3 PC",color=colors[metadata[,1]], cex.lab=1, type="p", pch=19)
layout(matrix(1:2, ncol=2))
scatterplot3d(bfeats3.mds_scale$points[,1], bfeats3.mds_scale$points[,2], bfeats3.mds_scale$points[,3],
angle=75, main="3D Scatterplot on MDS (3 dim)", xlab="1 dim",
ylab="2 dim", zlab="3 dim", color=colors[metadata3[,1]], pch=19, cex.lab=1, type="p")
scatterplot3d(bfeats3.pca_cor$scores[,1], bfeats3.pca_cor$scores[,2], bfeats3.pca_cor$scores[,3],
angle=75, main="3D Scatterplot on 1., 2., 3. PC", xlab="1 PC",
ylab="2 PC", zlab="3 PC",color=colors[metadata3[,1]], cex.lab=1, type="p", pch=19)
layout(matrix(1:2, ncol=2))
scatterplot3d(bfeats3.mds_scale$points[,1], bfeats3.mds_scale$points[,2], bfeats3.mds_scale$points[,3],
angle=75, main="3D Scatterplot on MDS (3 dim)", xlab="1 dim",
ylab="2 dim", zlab="3 dim", color=colors[bfeats3[,1]], pch=19, cex.lab=1, type="p")
scatterplot3d(bfeats3.pca_cor$scores[,1], bfeats3.pca_cor$scores[,2], bfeats3.pca_cor$scores[,3],
angle=75, main="3D Scatterplot on 1., 2., 3. PC", xlab="1 PC",
ylab="2 PC", zlab="3 PC",color=colors[bfeats3[,1]], cex.lab=1, type="p", pch=19)
bfeats3.mds_custom = mds.custom(bfeats3.dist_scale, 20)
bfeats3.mds_custom
mds.custom <- function(dist_mat, dim) {
#calculate A from distance matrix
A = -0.5*as.matrix(dist_mat)^2
#centering the matrix
B = A - outer(rowMeans(A), colMeans(A), "+") + mean(A)
#calculate eigenvalues
eg = eigen(B)
X = NULL
#concatenate eigenvectors and variances
for(i in 1:dim) {
X = cbind(X, eg$vectors[,i] * sqrt(eg$values[i]))
}
data.frame(eig=eg, points=X)
}
bfeats3.mds_custom = mds.custom(bfeats3.dist_scale, 20)
str(bfeats3.mds_custom)
bfeats3.mds_custom$eig
bfeats3.mds_custom[,1]
bfeats3.mds_custom[1:5,1]
bfeats3.mds_custom[1:5,2]
cumsum(bfeats3.mds_custom[1:20,1])/sum(bfeats3.mds_custom[1:20,1])
plot(bfeats3.mds_custom[1:20,1], type="b", main="Scree diagram MDS (elbow)", xlab="Component number", ylab="Component value")
points(6, bfeats3.mds_custom[1:20,1], col="red", cex=2.5, lwd=1.5, pch=1)
cumsum(bfeats3.mds_custom[1:20,1])/sum(bfeats3.mds_custom[1:20,1])
plot(bfeats3.mds_custom[1:20,1], type="b", main="Scree diagram MDS (elbow)", xlab="Component number", ylab="Component value")
points(6, bfeats3.mds_custom[6,1], col="red", cex=2.5, lwd=1.5, pch=1)
layout(matrix(1:2, ncol=2))
scatterplot3d(bfeats3.mds_scale$points[,1], bfeats3.mds_scale$points[,2], bfeats3.mds_scale$points[,3],
angle=75, main="3D Scatterplot on MDS (3 dim) built-in", xlab="1 dim",
ylab="2 dim", zlab="3 dim", color=colors[bfeats3[,1]], pch=19, cex.lab=1, type="p")
scatterplot3d(bfeats3.mds_custom[,2], bfeats3.mds_custom[,3], bfeats3.mds_custom[,4],
angle=75, main="3D Scatterplot on MDS (3 dim) custom", xlab="1 dim",
ylab="2 dim", zlab="3 dim",color=colors[bfeats3[,1]], cex.lab=1, type="p", pch=19)
bfeats3.dist_scale.cm = dist(as.data.frame(apply(bfeats3[,2:18], 2, scale)))
bfeats3.mds_scale.cm = cmdscale(bfeats3.dist_scale.cm, k = 20, eig=TRUE, add = FALSE, x.ret = FALSE)
layout(matrix(1:2, ncol=2))
scatterplot3d(bfeats3.mds_scale$points[,1], bfeats3.mds_scale$points[,2], bfeats3.mds_scale$points[,3],
angle=75, main="3D Scatterplot on MDS (3 dim)", xlab="1 dim",
ylab="2 dim", zlab="3 dim", color=colors[bfeats3[,1]], pch=19, cex.lab=1, type="p")
scatterplot3d(bfeats3.pca_cor$scores[,1], bfeats3.pca_cor$scores[,2], bfeats3.pca_cor$scores[,3],
angle=75, main="3D Scatterplot on 1., 2., 3. PC", xlab="1 PC",
ylab="2 PC", zlab="3 PC",color=colors[bfeats3[,1]], cex.lab=1, type="p", pch=19)
cumsum(bfeats3.mds_scale.cm$eig[1:20])/sum(bfeats3.mds_scale.cm$eig[1:20])
plot(bfeats3.mds_scale.cm$eig[1:20], type="b", main="Scree diagram CM-MDS", xlab="Component number", ylab="Component value")
plot(bfeats3.mds_scale.cm$eig[1:20], type="b", main="Scree diagram CM-MDS (elbow)", xlab="Component number", ylab="Component value")
points(5, bfeats3.mds_scale.cm$eig[5], col="red", cex=2.5, lwd=1.5, pch=1)
pairs_noreg.custom(bfeats3.mds_scale.cm$points[,1:5], m="Scatterplot on CM-MDS")
layout(matrix(1))
pairs_noreg.custom(bfeats3.mds_scale.cm$points[,1:5], m="Scatterplot on CM-MDS", col=colors[metadata3[,1]],
legend.title="Number of blocks",
legend.text=c("3 blocks", "5 blocks", "7 blocks"), legend.col=colors[c(3,5,7)])
pairs_noreg.custom(bfeats3.mds_scale.cm$points[,1:5], m="Scatterplot on CM-MDS", col=colors[bfeats3[,1]],
legend.title = "Topology", legend.text = c("funnel", "random"),
legend.col=colors[1:10])
scatterplot3d.custom(bfeats3.mds_scale.cm$points[,1], bfeats3.mds_scale.cm$points[,2], bfeats3.mds_scale.cm$points[,3],
angle=75, main="3D Scatterplot on 1., 2., 3. CM-dimensions", xlab="1 dim",
ylab="2 dim", zlab="3 dim",col=colors[1], legend.title="no", legend.col=NULL, legend.text=NULL)
scatterplot3d.custom(bfeats3.mds_scale.cm$points[,1], bfeats3.mds_scale.cm$points[,2], bfeats3.mds_scale.cm$points[,3],
angle=75, main="3D Scatterplot on 1., 2., 3. CM-dimensions", xlab="1 dim",
ylab="2 dim", zlab="3 dim", col=colors[metadata3[,1]], legend.title="Number of blocks",
legend.text=c("3 blocks", "5 blocks", "7 blocks"), legend.col=colors[c(3,5,7)])
scatterplot3d.custom(bfeats3.mds_scale.cm$points[,1], bfeats3.mds_scale.cm$points[,2], bfeats3.mds_scale.cm$points[,3],
angle=75, main="3D Scatterplot on 1., 2., 3. CM-dimensions", xlab="1 dim",
ylab="2 dim", zlab="3 dim", col=colors[bfeats3[,1]], legend.title="Topology",
legend.text=c("funnel", "random"), legend.col=colors[c(1,2)])
bfeats3.dist_scale.cm = dist(as.data.frame(apply(bfeats3[,19:58], 2, scale)))
bfeats3.dist_scale.ela = dist(as.data.frame(apply(bfeats3[,19:58], 2, scale)))
bfeats3.dist_scale.cm = dist(as.data.frame(apply(bfeats3[,2:18], 2, scale)))
bfeats3.mds_scale.ela = cmdscale(bfeats3.dist_scale.ela, k = 20, eig=TRUE, add = FALSE, x.ret = FALSE)
cumsum(bfeats3.mds_scale.ela$eig[1:20])/sum(bfeats3.mds_scale.ela$eig[1:20])
plot(bfeats3.mds_scale.ela$eig[1:20], type="b", main="Scree diagram ELA-MDS", xlab="Component number", ylab="Component value")
plot(bfeats3.mds_scale.ela$eig[1:20], type="b", main="Scree diagram ELA-MDS", xlab="Component number", ylab="Component value")
plot(bfeats3.pca_cor.ela$sdev, type="b", main="Scree diagram ELA-PCA on cor", xlab="Component number", ylab="Component variance")
plot(bfeats3.mds_scale.ela$eig[1:20], type="b", main="Scree diagram ELA-MDS (elbow)", xlab="Component number", ylab="Component value")
points(5, bfeats3.mds_scale.ela$eig[5], col="red", cex=2.5, lwd=1.5, pch=1)
pairs_noreg.custom(bfeats3.mds_scale.ela$points[,1:5], m="Scatterplot on ELA-MDS")
pairs_noreg.custom(bfeats3.mds_scale.ela$points[,1:5], m="Scatterplot on ELA-MDS", col=colors[metadata3[,1]],
legend.title="Number of blocks",
legend.text=c("3 blocks", "5 blocks", "7 blocks"), legend.col=colors[c(3,5,7)])
pairs_noreg.custom(bfeats3.mds_scale.ela$points[,1:5], m="Scatterplot on ELA-MDS", col=colors[bfeats3[,1]],
legend.title = "Topology", legend.text = c("funnel", "random"),
legend.col=colors[1:10])
pairs_noreg.custom(bfeats3.pca_cor.ela$scores[,1:5], m="Scatterplot on PCs", col=colors[bfeats3[,1]],
legend.title = "Topology", legend.text = c("funnel", "random"),
legend.col=colors[1:10])
scatterplot3d.custom(bfeats3.mds_scale.ela$points[,1], bfeats3.mds_scale.ela$points[,2], bfeats3.mds_scale.ela$points[,3],
angle=75, main="3D Scatterplot on 1., 2., 3. ELA-dimensions", xlab="1 dim",
ylab="2 dim", zlab="3 dim",col=colors[1], legend.title="no", legend.col=NULL, legend.text=NULL)
scatterplot3d.custom(bfeats3.mds_scale.ela$points[,1], bfeats3.mds_scale.ela$points[,2], bfeats3.mds_scale.ela$points[,3],
angle=75, main="3D Scatterplot on 1., 2., 3. ELA-dimensions", xlab="1 dim",
ylab="2 dim", zlab="3 dim", col=colors[metadata3[,1]], legend.title="Number of blocks",
legend.text=c("3 blocks", "5 blocks", "7 blocks"), legend.col=colors[c(3,5,7)])
scatterplot3d.custom(bfeats3.mds_scale.ela$points[,1], bfeats3.mds_scale.ela$points[,2], bfeats3.mds_scale.ela$points[,3],
angle=75, main="3D Scatterplot on 1., 2., 3. ELA-dimensions", xlab="1 dim",
ylab="2 dim", zlab="3 dim", col=colors[bfeats3[,1]], legend.title="Topology",
legend.text=c("funnel", "random"), legend.col=colors[c(1,2)])
scatterplot3d.custom(bfeats3.mds_scale.ela$points[,1], bfeats3.mds_scale.ela$points[,2], bfeats3.mds_scale.ela$points[,3],
angle=115, main="3D Scatterplot on 1., 2., 3. ELA-dimensions", xlab="1 dim",
ylab="2 dim", zlab="3 dim", col=colors[bfeats3[,1]], legend.title="Topology",
legend.text=c("funnel", "random"), legend.col=colors[c(1,2)])
scatterplot3d.custom(bfeats3.mds_scale.ela$points[,1], bfeats3.mds_scale.ela$points[,2], bfeats3.mds_scale.ela$points[,3],
angle=145, main="3D Scatterplot on 1., 2., 3. ELA-dimensions", xlab="1 dim",
ylab="2 dim", zlab="3 dim", col=colors[bfeats3[,1]], legend.title="Topology",
legend.text=c("funnel", "random"), legend.col=colors[c(1,2)])
scatterplot3d.custom(bfeats3.mds_scale.ela$points[,1], bfeats3.mds_scale.ela$points[,2], bfeats3.mds_scale.ela$points[,3],
angle=165, main="3D Scatterplot on 1., 2., 3. ELA-dimensions", xlab="1 dim",
ylab="2 dim", zlab="3 dim", col=colors[bfeats3[,1]], legend.title="Topology",
legend.text=c("funnel", "random"), legend.col=colors[c(1,2)])
scatterplot3d.custom(bfeats3.mds_scale.ela$points[,1], bfeats3.mds_scale.ela$points[,2], bfeats3.mds_scale.ela$points[,3],
angle=175, main="3D Scatterplot on 1., 2., 3. ELA-dimensions", xlab="1 dim",
ylab="2 dim", zlab="3 dim", col=colors[bfeats3[,1]], legend.title="Topology",
legend.text=c("funnel", "random"), legend.col=colors[c(1,2)])
scatterplot3d.custom(bfeats3.mds_scale.ela$points[,1], bfeats3.mds_scale.ela$points[,2], bfeats3.mds_scale.ela$points[,3],
angle=205, main="3D Scatterplot on 1., 2., 3. ELA-dimensions", xlab="1 dim",
ylab="2 dim", zlab="3 dim", col=colors[bfeats3[,1]], legend.title="Topology",
legend.text=c("funnel", "random"), legend.col=colors[c(1,2)])
#and not of evaluation process as num blocks
scatterplot3d.custom(bfeats3.mds_scale.ela$points[,1], bfeats3.mds_scale.ela$points[,2], bfeats3.mds_scale.ela$points[,3],
angle=225, main="3D Scatterplot on 1., 2., 3. ELA-dimensions", xlab="1 dim",
ylab="2 dim", zlab="3 dim", col=colors[bfeats3[,1]], legend.title="Topology",
legend.text=c("funnel", "random"), legend.col=colors[c(1,2)])
scatterplot3d.custom(bfeats3.mds_scale.ela$points[,1], bfeats3.mds_scale.ela$points[,2], bfeats3.mds_scale.ela$points[,3],
angle=135, main="3D Scatterplot on 1., 2., 3. ELA-dimensions", xlab="1 dim",
ylab="2 dim", zlab="3 dim", col=colors[bfeats3[,1]], legend.title="Topology",
legend.text=c("funnel", "random"), legend.col=colors[c(1,2)])
scatterplot3d.custom(bfeats3.mds_scale.ela$points[,1], bfeats3.mds_scale.ela$points[,2], bfeats3.mds_scale.ela$points[,3],
angle=135, main="3D Scatterplot on 1., 2., 3. ELA-dimensions", xlab="1 dim",
ylab="2 dim", zlab="3 dim",col=colors[1], legend.title="no", legend.col=NULL, legend.text=NULL)
scatterplot3d.custom(bfeats3.pca_cor$scores[,1], bfeats3.pca_cor$scores[,2], bfeats3.pca_cor$scores[,3],
angle=75, main="3D Scatterplot on 1., 2., 3. PC", xlab="1 PC",
ylab="2 PC", zlab="3 PC", col=colors[metadata3[,1]], legend.title="Number of blocks",
legend.text=c("3 blocks", "5 blocks", "7 blocks"), legend.col=colors[c(3,5,7)])
round(summary(bfeats3.pca_cor, loadings = TRUE)$loadings[,1:6], 3)
pairs_noreg.custom(bfeats3.pca_cor$scores[,1:6], m="Scatterplot on PCs")
pairs_noreg.custom(bfeats3.pca_cor$scores[which(metadata3[,1]==3),1:6], m="Scatterplot on PCs")
pairs_noreg.custom(bfeats3.pca_cor$scores[which(metadata3[,1]==3),1:6], m="Scatterplot on PCs", col=colors[bfeats3[,1]],
legend.title = "Topology", legend.text = c("funnel", "random"),
legend.col=colors[1:10])
scatterplot3d.custom(bfeats3.pca_cor$scores[which(metadata3[,1]==3),1], bfeats3.pca_cor$scores[which(metadata3[,1]==3),2], bfeats3.pca_cor$scores[which(metadata3[,1]==3),3],
angle=75, main="3D Scatterplot on 1., 2., 3. PC", xlab="1 PC",
ylab="2 PC", zlab="3 PC",col=colors[1], legend.title="no", legend.col=NULL, legend.text=NULL)
pairs_noreg.custom(bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3),1:5], m="Scatterplot on PCs", col=colors[bfeats3[,1]],
legend.title = "Topology", legend.text = c("funnel", "random"),
legend.col=colors[1:10])
scatterplot3d.custom(bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3),1], bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3),2], bfeats3.pca_cor.cm$scores[which(metadata3[,1]==3),3],
angle=75, main="3D Scatterplot on 1., 2., 3. CM-PC", xlab="1 PC",
ylab="2 PC", zlab="3 PC",col=colors[1], legend.title="no", legend.col=NULL, legend.text=NULL)
scatterplot3d.custom(bfeats3.pca_cor$scores[which(metadata3[,1]==3 & bfeats3[,1]==1),1], bfeats3.pca_cor$scores[which(metadata3[,1]==3 & bfeats3[,1]==1),2], bfeats3.pca_cor$scores[which(metadata3[,1 & bfeats3[,1]==1]==3),3],
angle=75, main="3D Scatterplot on 1., 2., 3. PC", xlab="1 PC",
ylab="2 PC", zlab="3 PC",col=colors[1], legend.title="no", legend.col=NULL, legend.text=NULL)
scatterplot3d.custom(bfeats3.pca_cor$scores[which(metadata3[,1]==3 & bfeats3[,1]==1),1], bfeats3.pca_cor$scores[which(metadata3[,1]==3 & bfeats3[,1]==1),2], bfeats3.pca_cor$scores[which(metadata3[,1]==3 & bfeats3[,1] == 1),3],
angle=75, main="3D Scatterplot on 1., 2., 3. PC", xlab="1 PC",
ylab="2 PC", zlab="3 PC",col=colors[1], legend.title="no", legend.col=NULL, legend.text=NULL)
